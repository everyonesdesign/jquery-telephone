/*Telephone - v0.0.1 - 2014-07-28
* https://github.com/everyonesdesign/jquery-telephone.git
* Copyright (c) 2014 Trambitskiy Yura;
* Licensed MIT 
*/

!function(a){a.fn.telephone=function(b){function c(a){for(var b=0;b<i.length;b++)m.disc.css(i[b]+"transform","rotate("+a+"deg)")}function d(a){if(!m.disc.rotate)return null;var b=m.discContainer.offset(),c=b.left+m.disc.outerWidth()/2,d=b.top+m.disc.outerHeight()/2,e=a.pageX,f=a.pageY,g=Math.atan2(e-c,f-d),h=g*(180/Math.PI)*-1+90;return 0>h&&(h+=360),h>0&&45>h?h=0:h>45&&90>h&&(h=90),h}function e(b){a(j).stop(),m.disc.rotate=!0,m.disc.finish=!1,k=d(b)}function f(b){0!=b&&(j.deg=b,m.disc.finish=!0,a(j).animate({deg:360},{duration:500,step:function(a){for(var b=0;b<i.length;b++)c(a)},complete:function(){m.disc.rotate=!1,m.disc.finish=!1}}))}var g=a(this),h=a(document.body),i=["-moz-","-webkit-","-o-","-ms-",""],j={deg:0},k=0,l={};b=a.extend(l,b);var m={};m.object=a("<div class='jqt-container' style='display: none; position: absolute;'></div>"),m.tabs=a("<ul class='jqt-tabs'><li class='jqt-tab'>Buttons</li><li class='jqt-tab'>Disc</li></ul>");for(var n="",o=1;10>o;o++)n+="<li class='jqt-button jqt-button"+o+"'>"+o+"</li>";n+="<li class='jqt-button jqt-button0'>0</li>",m.buttons=a("<ul class='jqt-buttonsContainer'>"+n+"</ul>"),m.disc=a("<div class='jqt-disc'></div>");for(var p="",o=1;10>o;o++)p+="<li class='jqt-discNumber jqt-discNumber"+o+"'>"+o+"</li>";return p+="<li class='jqt-discNumber jqt-discNumber0'>0</li>",m.discContainer=a("<div class='jqt-discContainer'><ul class='jqt-discNumbersContainer'>"+p+"</ul></div>"),m.disc.rotate=!1,m.disc.finish=!1,m.object.on({click:function(a){a.stopPropagation()}}),h.append(m.object),m.object.append(m.tabs),m.buttons.on("click","li",function(a){m.object.$input.val(m.object.$input.val()+a.target.innerHTML)}),m.object.append(m.buttons),m.discContainer.append(m.disc),m.disc.on({mousedown:function(a){e(a),c(d(a))}}),m.object.append(m.discContainer),g.each(function(){var b=a(this);b.is(":text")&&b.on({focus:function(){var a=b.offset();m.object.show().css({top:a.top+b.outerHeight(),left:a.left}).$input=b},click:function(a){a.stopPropagation()}})}),h.on({click:function(){m.disc.rotate||m.object.hide()},mouseup:function(a){m.disc.rotate&&!m.disc.finish&&f(d(a))},mousemove:function(a){if(m.disc.rotate&&!m.disc.finish){var b=d(a);c(b)}}}),this}}(jQuery);